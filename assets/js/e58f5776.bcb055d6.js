"use strict";(self.webpackChunkcmta_reviewer=self.webpackChunkcmta_reviewer||[]).push([[5468],{8848:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var d=r(6540),o=r(839),i=r(3962),n=r(8185),s=r(6614),l=r(4848);function a(){const[e,t]=(0,d.useState)([]),[r,o]=(0,d.useState)(null);(0,d.useEffect)(()=>{i()},[]);const i=async()=>{const e=(0,n.query)((0,n.collection)(s.db,"payments"),(0,n.My)("createdAt","desc")),r=await(0,n.getDocs)(e);t(r.docs.map(e=>({id:e.id,...e.data()})))},a=async(e,t)=>{await(0,n.mZ)((0,n.H9)(s.db,"payments",e),{status:t,updatedAt:new Date}),i()};return(0,l.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,l.jsx)("h2",{style:{marginBottom:"1rem"},children:"\ud83d\udcca Payments Dashboard"}),(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Email"}),(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Tier"}),(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Status"}),(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Receipt"}),(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Date/Time"}),(0,l.jsx)("th",{style:{padding:"16px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Actions"})]})}),(0,l.jsx)("tbody",{children:e.map((e,t)=>(0,l.jsxs)("tr",{style:{backgroundColor:t%2==0?"#fff":"#f8f9fa",borderBottom:"1px solid #dee2e6"},children:[(0,l.jsx)("td",{style:{padding:"16px"},children:e.email}),(0,l.jsx)("td",{style:{padding:"16px"},children:(0,l.jsx)("span",{style:{padding:"4px 8px",borderRadius:"12px",backgroundColor:"premium"===e.tier?"#e3f2fd":"#f3e5f5",color:"premium"===e.tier?"#1565c0":"#7b1fa2",fontSize:"12px",fontWeight:"500"},children:e.tier})}),(0,l.jsx)("td",{style:{padding:"16px"},children:(0,l.jsx)("span",{style:{padding:"4px 8px",borderRadius:"12px",backgroundColor:"approved"===e.status?"#e8f5e8":"rejected"===e.status?"#ffebee":"#fff3e0",color:"approved"===e.status?"#2e7d32":"rejected"===e.status?"#c62828":"#ef6c00",fontSize:"12px",fontWeight:"500"},children:e.status||"pending"})}),(0,l.jsx)("td",{style:{padding:"16px"},children:e.receiptBase64?(0,l.jsx)("button",{onClick:()=>o(e),style:{padding:"6px 12px",backgroundColor:"#1a73e8",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\ud83d\udcc4 View Receipt"}):(0,l.jsx)("span",{style:{color:"#999",fontSize:"12px"},children:"No receipt"})}),(0,l.jsx)("td",{style:{padding:"16px",fontSize:"14px"},children:e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleString():"-"}),(0,l.jsxs)("td",{style:{padding:"16px",display:"flex",gap:"8px"},children:[(0,l.jsx)("button",{onClick:()=>a(e.id,"approved"),style:{padding:"4px 8px",backgroundColor:"#4caf50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:"\u2705 Approve"}),(0,l.jsx)("button",{onClick:()=>a(e.id,"rejected"),style:{padding:"4px 8px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:"\u274c Reject"})]})]},e.id))})]})}),r&&(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:(0,l.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,l.jsx)("h3",{children:"Payment Receipt"}),(0,l.jsx)("button",{onClick:()=>o(null),style:{backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",padding:"8px 12px",cursor:"pointer",fontSize:"14px"},children:"\u2715 Close"})]}),r.receiptBase64&&(0,l.jsx)("img",{src:r.receiptBase64,alt:"Receipt",style:{maxWidth:"100%",maxHeight:"70vh",border:"1px solid #ddd",borderRadius:"4px"}})]})})]})}function c(){const[e,t]=(0,d.useState)([]),[r,o]=(0,d.useState)(""),[i,a]=(0,d.useState)("all"),[c,f]=(0,d.useState)(1);(0,d.useEffect)(()=>{m()},[]);const m=async()=>{const e=await(0,n.getDocs)((0,n.collection)(s.db,"payments"));t(e.docs.map(e=>({id:e.id,...e.data()})))},b=async(e,t)=>{await(0,n.mZ)((0,n.H9)(s.db,"payments",e),{tier:t}),m()},y=(0,d.useMemo)(()=>e.filter(e=>{const t=e.email?.toLowerCase().includes(r.toLowerCase())||e.displayName?.toLowerCase().includes(r.toLowerCase()),d="all"===i||e.tier===i;return t&&d}),[e,r,i]),j=Math.ceil(y.length/20),C=y.slice(20*(c-1),20*c);return(0,l.jsxs)("div",{style:{padding:"2rem",backgroundColor:"#f8f9fa",borderRadius:"8px",marginBottom:"2rem"},children:[(0,l.jsx)("h2",{style:{color:"#1a73e8",marginBottom:"1rem"},children:"\ud83d\udc65 User Dashboard"}),(0,l.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[(0,l.jsx)("input",{type:"text",placeholder:"Search by email or name...",value:r,onChange:e=>o(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",flex:"1 1 250px"}}),(0,l.jsxs)("select",{value:i,onChange:e=>a(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc"},children:[(0,l.jsx)("option",{value:"all",children:"All Tiers"}),(0,l.jsx)("option",{value:"free",children:"Free"}),(0,l.jsx)("option",{value:"premium",children:"Premium"})]})]}),(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff"},children:[(0,l.jsx)("thead",{style:{backgroundColor:"#e3f2fd"},children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{style:p,children:"Email"}),(0,l.jsx)("th",{style:p,children:"Tier"}),(0,l.jsx)("th",{style:p,children:"Premium Expiry"}),(0,l.jsx)("th",{style:p,children:"Actions"})]})}),(0,l.jsx)("tbody",{children:0===C.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"4",style:{padding:"12px",textAlign:"center",color:"#666"},children:"No users found."})}):C.map(e=>(0,l.jsxs)("tr",{style:{backgroundColor:e.disabled?"#ffebee":"#fff"},children:[(0,l.jsx)("td",{style:x,children:e.email}),(0,l.jsx)("td",{style:x,children:(0,l.jsx)("span",{style:{padding:"4px 8px",borderRadius:"12px",backgroundColor:"premium"===e.tier?"#e8f5e9":"#fff3e0",color:"premium"===e.tier?"#2e7d32":"#ef6c00",fontWeight:"500"},children:e.tier||"free"})}),(0,l.jsx)("td",{style:x,children:e.createdAt?new Date(1e3*e.createdAt.seconds+2592e6).toLocaleDateString():"-"}),(0,l.jsx)("td",{style:x,children:(0,l.jsxs)("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[(0,l.jsx)("button",{style:h,onClick:()=>b(e.id,"premium"),children:"\ud83d\udd3c Upgrade"}),(0,l.jsx)("button",{style:u,onClick:()=>b(e.id,"free"),children:"\ud83d\udd3d Downgrade"}),(0,l.jsx)("button",{style:g,onClick:()=>(async e=>{await(0,n.mZ)((0,n.H9)(s.db,"payments",e),{disabled:!0}),m()})(e.id),children:"\ud83d\udeab Disable"})]})})]},e.id))})]})}),(0,l.jsx)("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center",gap:"0.5rem",flexWrap:"wrap"},children:Array.from({length:j},(e,t)=>t+1).map(e=>(0,l.jsx)("button",{onClick:()=>f(e),style:{padding:"6px 10px",borderRadius:"4px",border:e===c?"2px solid #1a73e8":"1px solid #ccc",backgroundColor:e===c?"#e3f2fd":"#fff",cursor:"pointer"},children:e},e))})]})}const p={padding:"12px",textAlign:"left",borderBottom:"2px solid #ccc"},x={padding:"12px",borderBottom:"1px solid #eee"},h={padding:"4px 8px",backgroundColor:"#4caf50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},u={padding:"4px 8px",backgroundColor:"#ff9800",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},g={padding:"4px 8px",backgroundColor:"#f44336",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"};var f=r(8774);const m="ceejay.hilario@gmail.com";function b(){const[e,t]=(0,d.useState)(null),[r,n]=(0,d.useState)(!1),[p,x]=(0,d.useState)(!0);(0,d.useEffect)(()=>{const e=(0,i.onAuthStateChanged)(s.auth,e=>{t(e),n(e?.email===m),x(!1)});return()=>e()},[]);const h=async()=>{const e=new i.GoogleAuthProvider;await(0,i.signInWithPopup)(s.auth,e)};return p?(0,l.jsx)(o.A,{title:"Admin Dashboard",children:(0,l.jsx)("p",{style:{textAlign:"center",padding:"2rem"},children:"Loading..."})}):e?r?(0,l.jsx)(o.A,{title:"Admin Dashboard",children:(0,l.jsxs)("div",{style:{padding:"2rem"},children:[(0,l.jsx)("h1",{style:{marginBottom:"1rem"},children:"\ud83d\udee0 Admin Dashboard"}),(0,l.jsx)("section",{style:{marginBottom:"3rem"},children:(0,l.jsx)(a,{})}),(0,l.jsx)("section",{style:{marginBottom:"3rem"},children:(0,l.jsx)(c,{})}),(0,l.jsxs)("section",{style:{textAlign:"center",marginTop:"2rem"},children:[(0,l.jsx)(f.A,{to:"/admin/quiz-editor",style:{padding:"12px 24px",backgroundColor:"#4CAF50",color:"#fff",fontWeight:"bold",borderRadius:"6px",textDecoration:"none",fontSize:"16px"},children:"\ud83d\udcdd Open Quiz Editor"}),(0,l.jsx)("p",{style:{marginTop:"8px",color:"#888"},children:"Manage quiz questions on a separate page"})]})]})}):(0,l.jsx)(o.A,{title:"Admin Dashboard",children:(0,l.jsxs)("div",{style:{textAlign:"center",padding:"2rem"},children:[(0,l.jsx)("h2",{children:"\ud83d\udeab Access Denied"}),(0,l.jsxs)("p",{children:["Sorry, ",e.email,", you do not have admin access."]})]})}):(0,l.jsx)(o.A,{title:"Admin Dashboard",children:(0,l.jsxs)("div",{style:{textAlign:"center",padding:"2rem"},children:[(0,l.jsx)("h2",{children:"\ud83d\udd12 Admin Login"}),(0,l.jsx)("p",{children:"Please log in with Google to continue"}),(0,l.jsx)("button",{onClick:h,children:"Login with Google"})]})})}}}]);